# üîß –°–∫—Ä–∏–ø—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è

–°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è Dog Feeding Bot –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

## üìã –°–∫—Ä–∏–ø—Ç—ã –≤ —ç—Ç–æ–π –ø–∞–ø–∫–µ

### 1. `status-yandex.sh` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –±–æ—Ç–∞ –∏ —Å–∏—Å—Ç–µ–º—ã  
**–ó–∞–ø—É—Å–∫:** –° –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞  
**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**

- ü§ñ –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–∞ –±–æ—Ç–∞ (PM2)
- üíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (CPU, RAM)
- üåê –°—Ç–∞—Ç—É—Å —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- üìä –ë–∞–∑–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
./scripts/maintenance/status-yandex.sh
```

### 2. `logs-yandex.sh` - –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–¥–æ–±–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±–æ—Ç–∞  
**–ó–∞–ø—É—Å–∫:** –° –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞  
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

- üìù –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏ PM2
- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–∂–∏–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- üéØ –§–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏ –±–æ—Ç–∞

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
./scripts/maintenance/logs-yandex.sh
```

### 3. `update-yandex.sh` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –±–æ—Ç–∞  
**–ó–∞–ø—É—Å–∫:** –° –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞  
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

- üì• –ó–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–æ–≤—ã–π –∫–æ–¥ –∏–∑ Git
- üì¶ –û–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (npm install)
- üî® –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç (npm run build)
- üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ —Å –Ω—É–ª–µ–≤—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –ø—Ä–æ—Å—Ç–æ—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
./scripts/maintenance/update-yandex.sh
```

### 4. `diagnose-connectivity.sh` - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º  
**–ó–∞–ø—É—Å–∫:** –ù–∞ VM –∏–ª–∏ —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞  
**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**

- üåê DNS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–º–µ–Ω–∞
- üîå –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Ä—Ç–æ–≤
- üõ°Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é firewall
- ‚öôÔ∏è –°–æ—Å—Ç–æ—è–Ω–∏–µ nginx
- üîç Security Groups –≤ Yandex Cloud

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
./scripts/maintenance/diagnose-connectivity.sh yourdomain.com
```

### 5. `reset-vm.sh` - –°–±—Ä–æ—Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –∏ –ø–µ—Ä–µ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ VM  
**–ó–∞–ø—É—Å–∫:** –° –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞  
**‚ö†Ô∏è –û–°–¢–û–†–û–ñ–ù–û:** –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ VM  
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

- üóëÔ∏è –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
- üßπ –û—á–∏—â–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
- üîÑ –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- üÜï –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç VM –∫ –Ω–æ–≤–æ–º—É —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
./scripts/maintenance/reset-vm.sh
```

### 6. `clear-db` - –û—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
**–ó–∞–ø—É—Å–∫:** –° –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –∏–ª–∏ VM
**‚ö†Ô∏è –û–°–¢–û–†–û–ñ–ù–û:** –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

- üßπ –û—á–∏—â–∞–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã (users, feedings, settings, scheduled_feedings)
- ‚öôÔ∏è –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü –∏ –∏–Ω–¥–µ–∫—Å—ã
- üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- üîí –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
# –ß–µ—Ä–µ–∑ npm script
npm run clear-db

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ ts-node
ts-node scripts/maintenance/clear-database.ts
```

## üö® –ü–æ—Ä—è–¥–æ–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ –±–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. `status-yandex.sh` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
2. `logs-yandex.sh` - –∞–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
3. `diagnose-connectivity.sh` - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–µ—Ç–∏ (–µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å webhook)

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å:

1. `update-yandex.sh` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
2. `status-yandex.sh` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:

1. `clear-db` - –æ—á–∏—Å—Ç–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Å–æ—Ö—Ä–∞–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É)
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞

### –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

1. `reset-vm.sh` - –ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å (—Ç–æ–ª—å–∫–æ –≤ –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ!)
2. –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `../deployment/deploy-yandex.sh`

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
ssh username@vm-ip "pm2 logs dog-feeding-bot --lines 0"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤:

```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
ssh username@vm-ip "pm2 monit"
```

## üîß –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

–ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º:

```bash
# –°—Ç–∞—Ç—É—Å
ssh username@vm-ip "pm2 status"

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
ssh username@vm-ip "pm2 restart dog-feeding-bot"

# –õ–æ–≥–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫)
ssh username@vm-ip "pm2 logs dog-feeding-bot --lines 50"

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
ssh username@vm-ip "pm2 stop dog-feeding-bot"

# –ó–∞–ø—É—Å–∫
ssh username@vm-ip "pm2 start dog-feeding-bot"
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- **–õ–æ–≥–∏:** –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –û–±–Ω–æ–≤–ª—è–π—Ç–µ –±–æ—Ç–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–±–æ—è—Ö
- **–ë—ç–∫–∞–ø—ã:** –î–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –≤–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** –†–µ–≥—É–ª—è—Ä–Ω–æ –æ—á–∏—â–∞–π—Ç–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é `clear-db`
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏—Å—Ç–µ–º—É
